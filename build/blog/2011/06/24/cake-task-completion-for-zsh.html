<!DOCTYPE html>
<html>
<head>
<meta content='width=device-width' name='viewport'>
<meta charset='utf-8'>
<meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
<title>Cake Task Completion for Zsh</title>
<link href="../../../../stylesheets/app-9744b2ed.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../../../../stylesheets/style-da39a3ee.css" media="screen" rel="stylesheet" type="text/css" />
<script src="../../../../javascripts/modernizr-e809af06.js" type="text/javascript"></script>
<script src="//use.typekit.net/iof8zoc.js" type="text/javascript"></script>
<script>
  try{Typekit.load();}catch(e){}
</script>
</head>
<body class='blog blog_2011 blog_2011_06 blog_2011_06_24 blog_2011_06_24_cake-task-completion-for-zsh'>
<div class='contain-to-grid'>
<nav class='top-bar'>
<ul class='title-area'>
<li class='name'>
<h1>
<a href="/">gorilla software</a>
</h1>
</li>
<li class='toggle-topbar menu-icon'>
<a href='#'>
<span></span>
</a>
</li>
</ul>
<section class='top-bar-section'>
<ul class='right'>
<li>
<a href="/#about">Was</a>
</li>
<li>
<a href="/#team">Wer</a>
</li>
<li>
<a href="/#services">Wie</a>
</li>
<li>
<a href="/#contact">Kontakt</a>
</li>
<li class='has-dropdown'>
<a href="/blog.html">Blog</a>
<ul class='dropdown'>
<li>
<label>Recent Articles</label>
</li>
<li>
<a href="/blog/2011/10/27/hide-os-x-mouse-cursor.html">Hide OS X Mouse Cursor</a>
</li>
<li>
<a href="/blog/2011/07/07/Path-and-Encirclement-Detection.html">Path and Encirclement Detection</a>
</li>
<li>
<a href="/blog/2011/06/29/Birom-Dilemma-I.html">Birom Dilemma I</a>
</li>
<li>
<a href="/blog/2011/06/28/MeFailEnglish.html">Me fail english</a>
</li>
<li>
<a href="/blog/2011/06/24/cake-task-completion-for-zsh.html">Cake Task Completion for Zsh</a>
</li>
<li>
<a href="/blog/2011/06/18/office.html">New Office</a>
</li>
<li>
<a href="/blog/2011/06/18/grids-and-coordinate-systems.html">Grids & Coordinate Systems</a>
</li>
<li><a href="/blog.html">See all →</a></li>
<li class='divider'></li>
<li>
<label>Tags</label>
</li>
<li>
<a href="/blog/tags/misc.html">misc (1)</a>
</li>
<li class='divider'></li>
<li>
<label>By Year</label>
</li>
<li>
<a href="/blog/2011.html">2011 (7)</a>
</li>
</ul>
</li>
</ul>
</section>
</nav>
</div>

<div class='row'>
<div class='content columns large-8'>
<h1>Cake Task Completion for Zsh</h1>
<div class='separator'>
<div class='line line-1'></div>
</div>
<p>Working on a node.js/coffeescript project I got tired of keeping in
mind and typing all the tasks defined in the Cakefile. As Cakefiles are very
similar to the Ruby Rakefiles, I had a look at existing solutions for
rake. The first google result pointed me to a 
<a href="http://weblog.rubyonrails.org/2006/3/9/fast-rake-task-completion-for-zsh">working snipped</a> I
already had lying around in my zsh.d directory. It turned out to be very
easy task to modify the rake completion.
Basically, I just needed to change the following line from</p>
<pre class="highlight shell">rake --silent --tasks | cut -d <span class="s2">&quot; &quot;</span> -f 2 &gt; .rake_tasks
</pre>
<p>to</p>
<pre class="highlight shell">cake | cut -d <span class="s2">&quot; &quot;</span> -f 2 &gt; .cake_tasks
</pre>
<p>Additionally, I removed the annoying &#39;Generating .*<em>tasks&#39; output. Add
an .cake</em>tasks line to the ignore list of your repository and you&#39;re
done.</p>

<p>The final zsh snippet looks like this. Add it to your <code>.zshrc</code> or to
some other location that gets loaded when zsh starts:</p>
<pre class="highlight shell">_cake_does_task_list_need_generating <span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> ! -f .cake_tasks <span class="o">]</span>; <span class="k">then return </span>0;
  <span class="k">else
    </span><span class="nv">accurate</span><span class="o">=</span><span class="k">$(</span>stat -f%m .cake_tasks<span class="k">)</span>
    <span class="nv">changed</span><span class="o">=</span><span class="k">$(</span>stat -f%m Cakefile<span class="k">)</span>
    <span class="k">return</span> <span class="k">$(</span>expr <span class="nv">$accurate</span> <span class="s1">&#39;&gt;=&#39;</span> <span class="nv">$changed</span><span class="k">)</span>
  <span class="k">fi</span>
<span class="o">}</span>
_cake <span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> -f Cakefile <span class="o">]</span>; <span class="k">then
    if </span>_cake_does_task_list_need_generating; <span class="k">then
      </span>cake | cut -d <span class="s2">&quot; &quot;</span> -f 2 &gt; .cake_tasks
    <span class="k">fi
    </span>compadd <span class="sb">`</span>cat .cake_tasks<span class="sb">`</span>
  <span class="k">fi</span>
<span class="o">}</span>
compdef _cake cake
</pre>
</div>
<aside class='nav columns large-4'>
<h2>Recent Articles</h2>
<ol>
<li>
<a href="/blog/2011/10/27/hide-os-x-mouse-cursor.html">Hide OS X Mouse Cursor</a>
<span>Oct 27</span>
</li>
<li>
<a href="/blog/2011/07/07/Path-and-Encirclement-Detection.html">Path and Encirclement Detection</a>
<span>Jul  7</span>
</li>
<li>
<a href="/blog/2011/06/29/Birom-Dilemma-I.html">Birom Dilemma I</a>
<span>Jun 29</span>
</li>
<li>
<a href="/blog/2011/06/28/MeFailEnglish.html">Me fail english</a>
<span>Jun 28</span>
</li>
<li>
<a href="/blog/2011/06/24/cake-task-completion-for-zsh.html">Cake Task Completion for Zsh</a>
<span>Jun 24</span>
</li>
<li>
<a href="/blog/2011/06/18/office.html">New Office</a>
<span>Jun 18</span>
</li>
<li>
<a href="/blog/2011/06/18/grids-and-coordinate-systems.html">Grids & Coordinate Systems</a>
<span>Jun 18</span>
</li>
</ol>
<h2>Tags</h2>
<ol>
<li>
<a href="/blog/tags/misc.html">misc</a>
(1)
</li>
</ol>
<h2>By Year</h2>
<ol>
<li>
<a href="/blog/2011.html">2011</a>
(7)
</li>
</ol>

</aside>
</div>
<div id='footer'>
<div class='ruler'></div>
<div class='newsletter row'>
<form action='http://gorillasoftware.us7.list-manage.com/subscribe/post?u=5a4a472acf94be0e77c5796b6&amp;id=e9c19870ae' method='post' name='mc-embedded-subscribe-form' novalidate='' target='_blank'>
<div class='columns medium-12 large-3'>
<h2>Newsletter</h2>
</div>
<div class='columns medium-9 large-7'>
<input class='email' id='newsletter' name='EMAIL' placeholder='email address' required='' type='email' value=''>
</div>
<div class='columns medium-3 large-2'>
<a onclick="$(this).closest(&quot;form&quot;).submit(); return false;" class="subscribe" href="#">Subscribe</a>
</div>
</form>
</div>
<div class='credits row'>
<div class='columns small-12'>Copyright © gorilla software GmbH 2011-2013. All Rights Reserved.</div>
</div>
</div>

<script src="http://code.jquery.com/jquery-1.10.1.min.js" type="text/javascript"></script>
<script src="../../../../javascripts/site-06704b5d.js" type="text/javascript"></script>

</body>
</html>
